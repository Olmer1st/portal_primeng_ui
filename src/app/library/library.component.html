<div class="relative">
    <ng-sidebar-container>
        <!-- A sidebar -->
        <ng-sidebar [(opened)]="_topBarOpened" mode="dock" dockedSize="16px" position="top">
            <searchpanel *ngIf="_topBarOpened" [genres]="genres" [languages]="languages" (onTogglePanelClicked)="onTogglePanelClicked()" (onStartSearch)="onStartSearch($event)"></searchpanel>
            <div class="float_center">
                <i class="fa fa-2x pointer" [ngClass]="{'fa-search-plus': !_topBarOpened,'fa-search-minus':_topBarOpened}" aria-hidden="true" (click)="_toggleSearchPanel()"></i>
            </div>
            <span class="clearfix"></span>
        </ng-sidebar>
        <!-- Page content -->
        <!-- sortField="series"sortMode="multiple" [rowsPerPageOptions]="[10,20,50]" [rows]="20" [paginator]="true" [pageLinks]="5" -->
        <spinner-section *ngIf="loadingData"></spinner-section>
        <p-dataTable [value]="books" *ngIf="!_topBarOpened" resizableColumns="true" reorderableColumns="true" columnResizeMode="fit" rowGroupMode="subheader" groupField="series" expandableRowGroups="true" [sortableRowGroup]="false" dataKey="file">
            <p-header *ngIf="selectedBooksFiles.length">
                <div class="ui-grid  ui-grid-pad ui-fluid" style="margin-top: 20px">
                    <div class="ui-grid-row" style="text-align:center;">
                        <div class="ui-grid-col-1">
                            <label class="first">Selected books: {{selectedBooksFiles.length}}</label>
                        </div>
                        <div class="ui-grid-col-1">
                            <button pButton type="button" (click)="selectedBooksFiles=[]" label="Clear" icon="fa-eraser" style="width:150px;"></button>
                        </div>
                        <div class="ui-grid-col-1">
                            <button pButton type="button" (click)="download($event)" label="Download" icon="fa-download" style="width:150px;"></button>
                        </div>
                    </div>
                    <ul>
                        <li *ngFor="let book of selectedBooksFiles" style="text-align: left;">
                            <div class="ellipsis"> {{getSelectedInfo(book)}}</div>
                        </li>
                        <!-- <ng-container *ngIf="getBookInfo(book) as bookInfo">
                                {{bookInfo?`${bookInfo.author} - ${bookInfo.title}`:""}}
                            </ng-container> -->

                    </ul>
                </div>
            </p-header>
            <p-footer>Total books found: {{books.length}}</p-footer>
            <ng-template pTemplate="rowgroupheader" let-rowData>{{rowData.series}}</ng-template>
            <p-column [style]="{'width':'38px'}">
                <ng-template let-node="rowData" pTemplate="body">
                    <p-checkbox name="bookfiles" value="{{node.file}}" [(ngModel)]="selectedBooksFiles"></p-checkbox>
                </ng-template>
            </p-column>
            <p-column [style]="{'width':'50px'}">
                <ng-template pTemplate="header">
                    <i class="fa fa-download" aria-hidden="true"></i>
                </ng-template>
                <ng-template let-node="rowData" pTemplate="body">
                    <button pButton type="text" (click)="downloadBook(node)" icon="fa-download"></button>
                </ng-template>
            </p-column>
            <p-column field="title" header="Title" [sortable]="false" [style]="{'width':'35%'}"></p-column>
            <p-column field="author" header="Author" [style]="{'width':'25%'}">
                <ng-template let-node="rowData" pTemplate="body">
                    <span style="white-space: normal;">{{node.author}}</span>
                </ng-template>
            </p-column>
            <!-- <p-column field="series" header="Serie" [sortable]="true" [style]="{'width':'25%'}"></p-column> -->
            <!-- <p-column field="serno" header="#" sortable="false" (sortFunction)="NumbersSort($event)" [style]="{'width':'3%'}"></p-column> -->
            <p-column field="serno" header="#" [style]="{'width':'3%'}"></p-column>
            <!-- sortable="false" (sortFunction)="NumbersSort($event)" -->
            <p-column field="size" header="Size" [style]="{'width':'5%'}">
                <ng-template let-node="rowData" pTemplate="body">
                    {{node.size | fileSize}}
                </ng-template>
            </p-column>
            <!-- <p-column field="date" header="Date"  sortable="false" (sortFunction)="DateSort($event)" [style]="{'width':'7%'}"></p-column> -->
            <p-column field="date" header="Date" [style]="{'width':'7%'}"></p-column>
            <p-column field="genre" header="Genre">
                <ng-template let-node="rowData" pTemplate="body">
                    <span style="white-space: normal;">{{node.genre}}</span>
                </ng-template>
            </p-column>

        </p-dataTable>
    </ng-sidebar-container>
</div>
